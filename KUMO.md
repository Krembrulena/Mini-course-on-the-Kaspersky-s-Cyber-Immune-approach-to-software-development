# Кибериммунное устройство мониторинга оборудования

## Содержание <a name="#содержание-"></a>
- [Концепция безопасности продукта](#концепция-безопасности-продукта-)
  - [Назначение документа](#назначение-документа-)
  - [Краткое описание назначения и применения продукта](#краткое-описание-назначения-и-применения-продукта-)
  - [Ценности продукта](#ценности-продукта-)
  - [Неприемлемые события или сценарии в отношении ценностей продукта](#неприемлемые-события-или-сценарии-в-отношении-ценностей-продукта-)
  - [Верхнеуровневые сценарии работы продукта](#верхнеуровневые-сценарии-работы-продукта-)
  - [Роли пользователей](#роли-пользователей-)
  - [Контекст работы системы](#контекст-работы-системы-)
- [Цели и предположения безопасности](#цели-и-предположения-безопасности-)
  - [Цели](#цели-)
  - [Предположения](#предположения-)
- [Сценарии использования](#сценарии-использования-)
- [Негативные сценарии использования](#негативные-сценарии-использования-)
- [Архитектура](#архитектура-)
## Концепция безопасности продукта <a name="#концепция-безопасности-продукта-"></a>
### Назначение документа <a name="#назначение-документа-"></a>
Этот документ пишется бизнес-заказчиком и должен описывать именно бизнес-потребности для различных типов пользователей (ролей) и верхнеуровневые ограничения, которые не являются частью решения. Текст документа должен быть написан простым понятным языком и не содержать сложных терминов и технических подробностей, если они не являются критически важными для дальнейшей проработки решения.

Этот документ используется как отправная точка для более глубокой технической проработки аналитиком и архитектором для формулировки целей и предположений безопасности, негативных сценариев.

### Краткое описание назначения и применения продукта <a name="#краткое-описание-назначения-и-применения-продукта-"></a>
Мониторинг микроклимата (автоматизированное непрерывное измерение и журналирование значений температуры, влажности и давления) в помещениях фармацевтического производства. Оповещение пользователей КУМО в случае возникновения аварийного события. Аварийным событием считается выход измеренных значений за пределы допустимого диапазона.

### Ценности продукта <a name="#ценности-продукта-"></a>
Оповещение пользователей об аварийных событиях.

### Неприемлемые события или сценарии в отношении ценностей продукта <a name="#неприемлемые-события-или-сценарии-в-отношении-ценностей-продукта-"></a>
* Отсутствие или задержка оповещения (более чем на N минут) при возникновении аварийного события.
* Потеря или подмена результатов измерений внутри КУМО, в результате которых может быть пропущено аварийное событие.

### Верхнеуровневые сценарии работы продукта <a name="#верхнеуровневые-сценарии-работы-продукта-"></a>
* КУМО с определенной периодичностью получает (LAN/Wi-fi/4G) от оборудования показатели микроклимата: температуру, влажность и давление.
* КУМО анализирует полученные значения на их нахождение внутри допустимого диапазона.
* В случае выхода измеренных значений за допустимые пределы, КУМО незамедлительно рассылает оповещения (уведомление в веб-приложении, смс) заинтересованным пользователям.
* КУМО журналирует полученные значения измерений и сохраняет их в хранилище.
* КУМО получает обновления с сервера производителя.

### Роли пользователей <a name="#роли-пользователей-"></a>
* Администратор КУМО.
* Пользователь КУМО.

### Контекст работы системы <a name="#контекст-работы-системы-"></a>
КУМО, измерительное оборудование и хранилище измеренных значений физически находятся внутри охраняемого периметра и взаимодействуют между собой по внутренней сети. Веб-приложение взаимодействует с КУМО из внешней сети.

## Цели и предположения безопасности <a name="#цели-и-предположения-безопасности-"></a>
### Цели <a name="#цели-"></a>

1. Обеспечить безопасное обновление КУМО (в том числе через недоверенные каналы связи).
2. Обеспечить корректную обработку результатов измерений и их передачу в доверенное хранилище безопасным образом.
3. Обеспечить возможность безопасного администрирования системы из внешней сети.
4. Обеспечить однонаправленную передачу данных от приложений, взаимодействующих с внутренней сетью, с приложениями, взаимодействующими с внешней сетью, без возможности воздействия на внутренние ресурсы со стороны внешней сети.

### Предположения <a name="#предположения-"></a>

1. КУМО работает в окружении, гарантирующем отсутствие физического доступа со стороны злоумышленника, в том числе для подключения напрямую к устройству.
2. КУМО имеет отдельные порты для подключения к внутренней и внешней сетям.
3. Низкий уровень угроз со стороны внутренней сети.
4. Все авторизованные пользователи КУМО благонадежны.
5. Физическая надежность и доступность доверенного хранилища не является целью безопасности КУМО.

## Сценарии использования <a name="#сценарии-использования-"></a>
1. Обычный пользователь авторизуется в веб-приложении, после чего имеет возможность получать оповещения об аварийных событиях и просматривать журналы.
2. Администратор авторизуется в веб-приложении, после чего имеет возможность получать оповещения об аварийных событиях, просматривать и редактировать журналы, изменять параметры системы.

## Негативные сценарии использования <a name="#негативные-сценарии-использования-"></a>
1. Злоумышленник подменяет обновление на поврежденное, чтобы исполнить вредоносный код на КУМО.
2. Злоумышленник пытается подобрать пароль к аккаунту Администратора.
3. Злоумышленник получает доступ во внутреннюю сеть (не через КУМО) и проводит атаку на КУМО из внутренней сети.

## Архитектура <a name="#архитектура-"></a>

```mermaid
%%{ init: { 'flowchart': { 'curve': 'monotoneX' } } }%%
graph LR
  classDef untrust fill:#fac8c8, stroke:red, color:black;
  classDef trust fill:#bfe9e3, stroke:#006d5d, color:black;
  classDef conversion fill:#fff9c3, stroke:#ffe810, color:black;
  classDef Sub fill:#e8e8e8, stroke: #e8e8e8;
  subgraph Inner ["Inner"]
    
    subgraph KUMO ["KUMO"]
      direction TB
      
      subgraph BL ["Buisness Logic"]
        direction LR
        in(Data Input)-->prc(Data Processor)-->out(Data Output)
        prc(Data Processor)-->log(Logger) 
      end
    log(Logger)-->str3[(Storage)]

    subgraph SU ["Secure Update"]
      direction LR
      mng(Manager)-->vrf(Verifier)
      upd(Updater)-->str1[(Storage)]
      vrf(Verifier)-->str1[(Storage)]
      vrf(Verifier)-->str2[(Storage)]
      mng(Manager)-->dwn(Downloader)
      dwn(Downloader)-->str2[(Storage)]
      mng(Manager)-->upd(Updater)   
      end
    end
    
    dev(Devices)-->in
    
  end  
  fs(FileServer)<-->|"Запрос и получение обновления"|dwn
  out-->wapp(Web App)
  wapp(Web App)-->mng
  wapp(Web App)-->log
  log-->wapp(Web App)
  

  class BL,SU Sub
  class str2,mng,dwn,fs,wapp untrust
  class upd,vrf,log conversion
  class str1,str3,dev,in,prc,out trust
  linkStyle 0,1,2,3,5,6,7,11,13,16 color:green, stroke: green;
  linkStyle 4,8,9,10,12,14,15 color:red, stroke: red; 
```
